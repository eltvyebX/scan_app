{% extends "base.html" %}
{% block content %}

<div class="card p-4">

    <h3 class="mb-3 text-center">إدخال عملية جديدة</h3>

    <form action="/confirm" method="post">

        <div class="mb-3">
            <label class="form-label fw-bold">رقم العملية</label>
            <input id="trx" type="text" class="form-control" name="trx_last4"
                   placeholder="مثال: 4892" required>
        </div>

        <div class="mb-3">
            <label class="form-label fw-bold">التاريخ والوقت</label>
            <input id="datetime" type="text" class="form-control" name="date_time"
                   readonly required>
        </div>

        <div class="mb-3">
            <label class="form-label fw-bold">المبلغ</label>
            <input type="number" step="0.01" class="form-control" name="amount" required>
        </div>

        <button type="submit" class="btn btn-primary w-100">حفظ العملية</button>

    </form>
</div>

<script>
    // توليد التاريخ والوقت بمجرد أن يبدأ المستخدم في كتابة رقم العملية
    document.getElementById("trx").addEventListener("input", function () {
        const now = new Date();

        const pad = n => n.toString().padStart(2, '0');

        const formatted =
            pad(now.getDate()) + "-" +
            pad(now.getMonth() + 1) + "-" +
            now.getFullYear() + " " +
            pad(now.getHours()) + ":" +
            pad(now.getMinutes()) + ":" +
            pad(now.getSeconds());

        document.getElementById("datetime").value = formatted;
    });
</script>

{% endblock %}
